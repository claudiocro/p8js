<banner:meta.banner>(function(e){function t(){e(this).addClass("dirty")}var i={options:{data:null,valueField:"value",prefix:"",title:""},_create:function(){this.element.addClass("p8-inputElem"),this.element.addClass("p8-valueField"),this.element.change(t);var i="";void 0!==this.options.data[this.options.valueField]&&(i=this.options.data[this.options.valueField]);var n=e("<input />").attr("type","text").attr("name",this.options.prefix+"-"+this.options.valueField).attr("title",this.options.title).attr("value",i);this.element.append(n),n.p8AddHint(),n.data("p8-inputElem-value",i),n.data("p8-inputElem-orgValue",i),n.blur(function(){e(this).data("p8-inputElem-value",e(this).attr("value"))})},initRules:function(){void 0!==this.options.rules&&this.element.find("input").rules("add",this.options.rules)}};e.widget("ui.p8ValueField",i);var n={options:{data:null,valueField:"value",prefix:"",title:"",showHint:!1},_create:function(){var i=e("<span>");i.addClass("p8-inputElem"),i.addClass("p8-valueField"),i.change(t);var n=this.element.parent();i.appendTo(n),this.element.appendTo(i),this.element.attr("name",this.options.valueField).attr("title",this.options.title).p8InfoTip(),this.options.showHint&&this.element.p8AddHint(),this.element.data("p8-inputElem-value",e(this).attr("value")),this.element.data("p8-inputElem-orgValue",e(this).attr("value")),this.element.blur(function(){e(this).data("p8-inputElem-value",e(this).attr("value"))}),this.element.focus(function(){e(this).valid()}),this.initRules()},initRules:function(){void 0!==this.options.rules&&this.element.rules("add",this.options.rules)}};e.widget("ui.p8ValueFieldT",n);var a={options:{data:{},typeField:"type",customValueField:"value2",types:null,prefix:"",title:"",cclass:""},_create:function(){this.element.addClass("p8-inputElem"),this.element.addClass("p8-typeSelect");var i=this.options.data[this.options.typeField],n=this.options.data[this.options.typeField];"CUSTOM"===i?(i=this.options.data[this.options.customValueField],n=this.options.data[this.options.customValueField]):void 0===i?i=this.options.types[0]:n=i,void 0===i&&(i="");var a=this.options.types,s=[];e.each(a,function(e,t){s.push(t)});var o=e("<input />").attr("value",i).attr("name",this.options.prefix+"-"+this.options.typeField).addClass(this.options.cclass).autocomplete({source:s,zIndex:99,minLength:0}),l=e("<a/>").button({label:"Open",text:!1,icons:{primary:"ui-icon-circle-triangle-s"}});l.click(function(){o.autocomplete("search",""),o.focus()}),this.element.append(o).append(l),this.element.change(t).bind("autocompletechange",t).bind("autocompleteselect",t).bind("autocompleteselect",function(e,t){o.data("p8-inputElem-value",t.item.value)}),n&&(o.data("p8-inputElem-orgValue",n),o.data("p8-inputElem-value",n)),o.focus(function(){e(this).valid()}).change(function(){e(this).data("p8-inputElem-value",e(this).attr("value"))})},initRules:function(){if(void 0!==this.options.rules){var e=this.element.find("input");e.rules("add",this.options.rules)}}};e.widget("ui.p8TypeSelect",a)})(jQuery),function(e){e.fn.p8uiTwoColPanel=function(t){var i=jQuery.extend({data:null,valueFields:[],prefix:"",innerClass:"form-row-inner"},t);return this.each(function(){for(var t=e(this),n=null,a=i.valueFields.length,s=0,o=0;a>o;o++){var l=i.valueFields[o];0===o%2&&(s=0,n=e('<div class="'+i.innerClass+" edit p8TwoCol-row-"+o/2+" "+a+'" />'),0===o&&n.addClass("p8TwoCol-row-first"),t.append(e('<div class="'+i.innerClass+'-wrap" />').append(n))),o===a-1&&null!==n&&n.addClass("p8TwoCol-row-last"),"text"===l.type?n.append(e("<span />").addClass("col-"+s).p8ValueField({data:i.data,valueField:l.value,prefix:i.prefix,title:l.title,rules:l.rules})):"select"===l.type&&n.append(e("<span />").addClass("col-"+s).p8TypeSelect({types:l.types,data:i.data,typeField:l.value,customValueField:l.customValueField,prefix:i.prefix,title:l.title,rules:{minlength:2,required:!0,messages:{minlength:"Please, at least {0} characters are necessary"}}})),s++}return e(this)})}}(jQuery),function(e){e.fn.p8uiSimpleSearchPanel=function(t){var i=jQuery.extend({okFunc:null,cancelFunc:null,cancelText:"Cancel",contentTop:null,contentRight:null,fieldName:"search",fieldTitle:"Search"},t);return this.each(function(){var t=e(this);if(null!==i.contentTop){var n=e('<div class="p8-simpleSearchPanel-top" />').append(i.contentTop);t.append(n)}var a=e("<input />").attr("type","text").attr("name",i.fieldName).attr("title",i.fieldTitle);a.keypress(function(t){var n=t.which?t.which:t.keyCode;13===n&&e.isFunction(i.okFunc)&&i.okFunc.call(this)});var s=e('<div class="p8-simpleSearchPanel-field" />');if(null!==i.contentRight&&s.append(i.contentRight),s.append(a),t.append(s),null!==i.buttons){var o=e('<div class="p8-simpleSearchPanel-button" />').append(e("<button />").html(i.cancelText).button().click(function(){}));t.append(o)}})}}(jQuery),function(e){function t(t){var i,n=[];null!==t.typeField&&(i={},i.value=t.typeField,i.customValueField=t.customValueField,i.types=t.types,i.title=e.i18n(t.i180nPackage,t.group),i.i180nPackage=t.i180nPackage,i.type="select",n.push(i));for(var a in t.mapping)i={},i.value=t.mapping[a],i.title=e.i18n(t.i180nPackage,t.group+"-"+a),i.type="text",i.rules=t.rules[a],n.push(i);t.valueFields=n}e.fn.p8uiCreateTypeValueMultiEditor=function(i){var n=jQuery.extend({valueField:"value",i180nPackage:"",mapping:null,typeField:null,customValueField:null,types:null,newCount:0,hiddenNewData:{},rules:{}},i);return null!==n.valueField&&null===n.mapping&&(n.mapping={VALUE_FIELD:n.valueField}),t(n),this.each(function(){return e(this).p8uiMultiEditor(n),e(this)})}}(jQuery),function(e){var t=function(e){return e.attr("id")},i={options:{group:"",title:"",innerSel:".form-row-inner",newCount:0,newFunc:null,allowNew:!0,initFunc:null,hiddenNewData:{},uniqueIdFunc:t},_create:function(){var t=this,i=t.element;null!==this.options.newFunc&&e("<a />").button({text:!1,label:"Add",icons:{primary:"ui-icon-plus"}}).addClass("add").hide().button().click(function(){t.addNew(!0)}).hide().appendTo(i),this.options.title=this.options.group,t.focused=!1},_decorateEditor:function(t){var i=this;t.addClass("form-row");var n=t.find(this.options.innerSel+"-wrap");if(n.prepend(e("<div><br /></div>").addClass("action-panel")),e.isFunction(this.options.newFunc)){if(t.hasClass("init-new"))return;var a=e("<a />").button({text:!1,label:"Delete",icons:{primary:"ui-icon-minus"}}).addClass("delete").click(function(){var n=!1;t.hasClass("new")?n=!0:t.addClass("deleted");var a=i.element.parents(".p8-scroll").data("jsp");if(i.element.find(".form-row").not(":hidden").size()>1){var s=t.height()+2,o=i.element.parents(".jspContainer:first").height(),l=i.element.parents(".jspPane:first"),r=l.height()+l.position().top;o>r-s&&a.scrollByY(-1*s,!0)}return t.animate({height:"toggle",opacity:"toggle"},{duration:600,easing:"easeInBack",complete:function(){n&&(i.element.find(".add").hide().appendTo(i.element),e(this).remove()),0===i.element.find(".form-row").not(":hidden").size()?i.addNew(!0):(i.updateAddButton(),a.reinitialise())}}),!0});t.find(this.options.innerSel+"-wrap:last").find(".action-panel").prepend(a),t.find("input").focus(function(){clearTimeout(i.blurTimer),i.focused||(i.focused=!0,i._trigger("focusgained",null,{item:this}))}),t.find("input").blur(function(){clearTimeout(i.blurTimer),i.focused=!1,i.blurTimer=setTimeout(function(){i.focused!==!0&&i._trigger("focuslost")},50)}),this.element.trigger("focus")}for(var s in this.options.hiddenNewData)n.append(e("<input/>").attr("type","hidden").attr("name",this.options.uniqueIdFunc.call(this,t)+"-"+s).attr("value",this.options.hiddenNewData[s]))},load:function(t){var i=this.options.newFunc;if(e.isFunction(i))for(var n=0,a=t.length;a>n;n++){var s=i.call(this,t[n]);this._decorateEditor(s),this.element.append(s),e(".p8-typeSelect",s).p8TypeSelect("initRules"),e(".p8-valueField",s).p8ValueField("initRules")}0===t.length&&this.addNew(),this.updateAddButton()},addNew:function(t){if(this.options.allowNew!==!1){var i=this,n=this.options.initFunc,a=this.options.newFunc;if(e.isFunction(n)&&0===this.element.find(".init-new").length)this.addInit(t);else if(e.isFunction(a)){this.element.find(".init-new").hide(200,function(){var t=i.element.find(".add");t.hide(),t.appendTo(i.element),e(this).remove()});var s=a.call(this);if(this.options.newCount=this.options.newCount+1,s.addClass("new"),this._decorateEditor(s),s.css("opacity",1),this.element.append(s),this.updateAddButton(),e(".p8-typeSelect",s).p8TypeSelect("initRules"),t){s.css("opacity",0);var o=this.element.parents(".p8-scroll").filter(":first");if(o.length>0){var l=o.data("jsp"),r=s.position().top,u=s.height()+2;l.reinitialise(),r+u>o.height()&&l.scrollByY(u,!0)}}s.hide(),s.css("opacity",1),void 0===t?s.show():s.animate({opacity:"toggle",height:"toggle"},{duration:600,easing:"easeOutBack",complete:function(){i.updateAddButton()}})}}},addInit:function(t){var i=this.options.initFunc;if(e.isFunction(i)){var n=i.call(this);if(this.options.newCount=this.options.newCount+1,n.addClass("init-new"),this._decorateEditor(n),n.css("opacity",1),this.element.append(n),this.updateAddButton(),t){var a=this.element.parents(".p8-scroll").filter(":first");if(a.length>0){var s=a.data("jsp"),o=n.position().top,l=n.height()+2;s.reinitialise(),o+l>a.height()&&s.scrollByY(l,!0)}}n.hide(),n.css("opacity",1),void 0===t?n.show():n.animate({opacity:"toggle",height:"toggle"},{duration:600,easing:"easeOutBack"})}},updateAddButton:function(){if(this.element.find(".form-row").removeClass("last").removeClass("first"),1===this.element.find(".form-row").not(":hidden").length?this.element.find(".form-row").not(":hidden").addClass("first").addClass("last"):(this.element.find(".form-row").not(":hidden").first().addClass("first"),this.element.find(".form-row").not(":hidden").last().addClass("last")),this.element.find(this.options.innerSel+"-wrap").removeClass("last").removeClass("first"),1===this.element.find(this.options.innerSel+"-wrap").not(":hidden").length?this.element.find(this.options.innerSel+"-wrap").not(":hidden").addClass("first").addClass("last"):(this.element.find(this.options.innerSel+"-wrap").not(":hidden").first().addClass("first"),this.element.find(this.options.innerSel+"-wrap").not(":hidden").last().addClass("last")),null!==this.options.newFunc&&this.element.find(".init-new").length>0){var e=this.element.find(".add");e.css("display","inline-block"),this.element.find(".init-new").find(".action-panel").prepend(e)}}};e.widget("ui.p8uiMultiEditor",i)}(jQuery);