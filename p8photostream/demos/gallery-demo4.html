<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

  <title>p8 photostream demo 4</title>

  <link href="../../external/jquery-ui.css" rel="stylesheet" type="text/css"/>
  <link href="demo.css" rel="stylesheet" type="text/css"/>
	
  <script type="text/javascript" language="javascript" src="../../external/jquery-1.7.1.js"></script>
  <script type="text/javascript" language="javascript" src="../../external/jquery-ui.js"></script>
  <script type="text/javascript" language="javascript" src="../../external/jquery.easing.1.3.js"></script>
  <script type="text/javascript" language="javascript" src="../../external/jquery.busy.js"></script>
  <script type="text/javascript" language="javascript" src="../../external/jquery.jtruncate.js"></script>

  <script type="text/javascript" language="javascript" src="../../p8core/src/p8core.js"></script>
  <script type="text/javascript" language="javascript" src="../src/p8photosurfer.js"></script>
  
 
  <script type="text/javascript" language="javascript">
  
  	$(document).ready(function() {
		var datas = [
			{image:'images/cat-1.jpg'},{image:'images/cat-2.jpg'},{image:'images/cat-3.jpg'},{image:'images/cat-4.jpg'},
			{image:'images/cat-5.jpg'},{image:'images/cat-6.jpg'},{image:'images/cat-7.jpg'},{image:'images/cat-8.jpg'},
			{image:'images/cat-5.jpg'},{image:'images/cat-6.jpg'},{image:'images/cat-7.jpg'},{image:'images/cat-8.jpg'},
			{image:'images/cat-1.jpg'},{image:'images/cat-2.jpg'},{image:'images/cat-3.jpg'},{image:'images/cat-4.jpg'}
		];
		
		var requestFunction = function() {
			var self = this;
			self._preProcessResponse();
			
			setTimeout(function() {
				self.allFeeds = self.allFeeds.concat(datas);
				
				self.feedStreamEnd = true;		
				self._postProcessResponse();
			
			}, 3000);
				

		}
		
		var galleryMove = function() {
			$('.page-count').text("page: "+($(this).p8JsonGallery('getCurrentCount')));
		};
		
		//create feeditems
		var createFeedContent = function(feed) {
			return $('<div class="summary"></div>').css({opacity:0}).html('<div class="summaryCont"><span class="feedTitle">'+feed.image+'</span></div>');
		}
		for ( var i=0; i<8; ++i ){
			$("#mainGallery").append($('<div></div>').p8FeedItem({contentFunc:createFeedContent}));
		}
		
		$('#mainGallery')
			.p8GalleryCreator({
				reload:				true,
				nextSelector:		$('.prevNextCont .next'),
				previousSelector:	$('.prevNextCont .previous'),
				feedLoaderFunction:	function(element,data) {element.p8FeedItem("load",data.image,data);},
				requestFunction: 	requestFunction,
				loadingFunction:	function(evt, p){$('.prefNavBusy').fadeTo(200, (p.loading) ? 1 : 0 );},
				moveForwards:		galleryMove,
				moveBackwards:		galleryMove
			})
			.p8SimpleGrid();
	});
	
	
  </script>
  
 
</head>

<body>
<div id="wrapper">


  <div style="margin-bottom: 10px;">
    <div class="prevNextCont" style="position: relative;">
      <a href="#" class="previous">Previous</a>&nbsp;|&nbsp;
  	  <a href="#" class="next">Next</a>
  	  <span class="prefNavBusy"><img src="images/busy.gif" valign="top" width=22 height=22 /></span>
  	  <span class="page-count"></span>
    </div>
  </div>
  
  
  
  <div>
    <div id="mainGallery">
    </div>
  </div>  
</div>
 
</body>
</html>
